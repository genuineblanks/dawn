{% comment %}
Tech-Pack Step 3: Garment Specifications Section
{% endcomment %}

{{ 'techpack-unified-styles.css' | asset_url | stylesheet_tag }}
<script src="{{ 'techpack-app.js' | asset_url }}" defer="defer"></script>

<!-- Step 3 Introduction Modal -->
<div id="step-3-intro-modal" class="techpack-modal" style="display: none;">
  <div class="techpack-modal__overlay">
    <div class="techpack-modal__content">
      <div class="techpack-modal__header">
        <h3 class="techpack-modal__title">Step 3: Order Specifications</h3>
      </div>
      <div class="techpack-modal__body">
        <p class="techpack-modal__text">
          This step defines your production order. The tech pack is a design reference only. Here you specify garment types, colorways, sizes and quantities. Any colorway or size not entered here will not be manufactured. Please review your tech pack and enter every colorway and quantity you intend to order.
        </p>
      </div>
      <div class="techpack-modal__footer">
        <button type="button" class="techpack-btn techpack-btn--primary" id="step-3-modal-continue">
          Continue to Order Specifications
          <svg class="techpack-btn__icon" width="16" height="16" viewBox="0 0 16 16">
            <path d="M6 12l4-4-4-4" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</div>

<section id="techpack-step-3" class="techpack-step" data-step="3" style="display: none;">
  <div class="techpack-container">
    <div class="techpack-progress">
      <div class="techpack-progress__bar">
        <div class="techpack-progress__fill" style="width: 75%"></div>
      </div>
      <div class="techpack-progress__steps">
        <div class="techpack-progress__step techpack-progress__step--completed">
          <div class="techpack-progress__step-circle techpack-progress__step-circle--completed">✓</div>
          <div class="techpack-progress__step-label">Client Info</div>
        </div>
        <div class="techpack-progress__step techpack-progress__step--completed">
          <div class="techpack-progress__step-circle techpack-progress__step-circle--completed">✓</div>
          <div class="techpack-progress__step-label">File Upload</div>
        </div>
        <div class="techpack-progress__step techpack-progress__step--active">
          <div class="techpack-progress__step-circle techpack-progress__step-circle--active">3</div>
          <div class="techpack-progress__step-label">Garment Details</div>
        </div>
        <div class="techpack-progress__step">
          <div class="techpack-progress__step-circle">4</div>
          <div class="techpack-progress__step-label">Review</div>
        </div>
      </div>
    </div>

    <div class="techpack-content">
      <h2 class="techpack-title">Garment Specifications</h2>
      <p class="techpack-subtitle">Define your garment details and quantity requirements</p>

      <div class="techpack-quantity-tracker">
        <div class="techpack-quantity-tracker__content">
          <span class="techpack-quantity-tracker__label">Total Quantity:</span>
          <span class="techpack-quantity-tracker__value" id="total-quantity">0</span>
          <span class="techpack-quantity-tracker__minimum">
            / <span id="min-text">75 minimum</span>
          </span>
        </div>
        <div class="techpack-quantity-tracker__bar">
          <div class="techpack-quantity-tracker__fill" id="quantity-progress" style="width: 0%"></div>
        </div>
      </div>

      <div class="techpack-garments" id="garments-container">
        <!-- Garments will be dynamically added here -->
      </div>

      <button type="button" class="techpack-btn techpack-btn--secondary techpack-btn--add-garment" id="add-garment">
        <svg class="techpack-btn__icon" width="16" height="16" viewBox="0 0 16 16">
          <path d="M8 2v12m-6-6h12" stroke="currentColor" stroke-width="2"/>
        </svg>
        Add Garment
      </button>

      <div class="techpack-form__actions">
        <button type="button" class="techpack-btn techpack-btn--ghost" id="step-3-prev">
          <svg class="techpack-btn__icon techpack-btn__icon--left" width="16" height="16" viewBox="0 0 16 16">
            <path d="M10 4L6 8l4 4" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
          Previous
        </button>
        <button type="button" class="techpack-btn techpack-btn--primary" id="step-3-next" disabled>
          Next Step
          <svg class="techpack-btn__icon" width="16" height="16" viewBox="0 0 16 16">
            <path d="M6 12l4-4-4-4" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </button>
      </div>
    </div>
  </div>
</section>

<!-- Garment Template -->
<template id="garment-template">
  <div class="techpack-garment" data-garment-id="">
    <div class="techpack-garment__header">
      <h3 class="techpack-garment__title">Garment <span class="techpack-garment__number"></span></h3>
      <button type="button" class="techpack-garment__remove" aria-label="Remove garment">
        <svg width="16" height="16" viewBox="0 0 16 16">
          <path d="M12 4L4 12m0-8l8 8" stroke="currentColor" stroke-width="2"/>
        </svg>
      </button>
    </div>

    <div class="techpack-garment__content">
      <div class="techpack-form__row">
        <div class="techpack-form__group techpack-form__group--required">
          <label class="techpack-form__label">Garment Type</label>
          <select class="techpack-form__select" name="garmentType" required>
            <option value="">Select garment type...</option>
            <option value="Zip-Up Hoodie">Zip-Up Hoodie</option>
            <option value="Hoodie">Hoodie</option>
            <option value="T-Shirt">T-Shirt</option>
            <option value="Crewneck Sweatshirt">Crewneck Sweatshirt</option>
            <option value="Sweatpants">Sweatpants</option>
            <option value="Shorts">Shorts</option>
            <option value="Long Sleeve T-Shirt">Long Sleeve T-Shirt</option>
            <option value="Polo Shirt">Polo Shirt</option>
            <option value="Tank Top">Tank Top</option>
            <option value="Hat/Cap">Hat/Cap</option>
            <option value="Beanie">Beanie</option>
            <option value="Other">Other (Specify in Notes)</option>
          </select>
          <div class="techpack-form__error" role="alert"></div>
        </div>

        <div class="techpack-form__group techpack-form__group--required">
          <label class="techpack-form__label">Fabric Type</label>
          <select class="techpack-form__select" name="fabricType" required>
            <option value="" selected>Select fabric type...</option>
            <option value="Fleece 100% Organic Cotton">Fleece 100% Organic Cotton</option>
            <option value="French Terry 100% Organic Cotton Fleece">French Terry 100% Organic Cotton</option>
            <option value="Cotton/Polyester Blend (50/50)">Cotton/Polyester Blend (50/50)</option>
            <option value="Cotton/Polyester Blend (70/30)">Cotton/Polyester Blend (70/30)</option>
            <option value="Cotton/Polyester Blend (80/20)">Cotton/Polyester Blend (80/20)</option>
            <option value="100% Polyester">100% Polyester</option>
            <option value="100% Linen">100% Linen</option>
            <option value="Cotton/Linen Blend">Cotton/Linen Blend</option>
            <option value="Jersey Knit">Jersey Knit</option>
            <option value="Pique">Pique</option>
            <option value="Canvas">Canvas</option>
            <option value="Custom Fabric">Custom Fabric (Specify in Notes)</option>
          </select>
          <div class="techpack-form__error" role="alert"></div>
        </div>
      </div>

      <div class="techpack-form__group techpack-form__group--required">
        <label class="techpack-form__label">Printing Methods (Select at least one) *</label>
        <div class="techpack-form__checkboxes techpack-form__checkboxes--compact">
          <label class="techpack-form__checkbox">
            <input type="checkbox" name="printingMethods[]" value="None">
            <span class="techpack-form__checkbox-mark"></span>
            None
          </label>
          <label class="techpack-form__checkbox">
            <input type="checkbox" name="printingMethods[]" value="Embroidery">
            <span class="techpack-form__checkbox-mark"></span>
            Embroidery
          </label>
          <label class="techpack-form__checkbox">
            <input type="checkbox" name="printingMethods[]" value="Screen Print">
            <span class="techpack-form__checkbox-mark"></span>
            Screen Print
          </label>
          <label class="techpack-form__checkbox">
            <input type="checkbox" name="printingMethods[]" value="Digital Print">
            <span class="techpack-form__checkbox-mark"></span>
            Digital Print
          </label>
          <label class="techpack-form__checkbox">
            <input type="checkbox" name="printingMethods[]" value="Other">
            <span class="techpack-form__checkbox-mark"></span>
            Other
          </label>
        </div>
        <div class="techpack-form__error" role="alert"></div>
      </div>

      <div class="techpack-colorways">
        <div class="techpack-colorways__header">
          <h4 class="techpack-colorways__title">Colorways</h4>
          <button type="button" class="techpack-btn techpack-btn--small techpack-btn--secondary add-colorway">
            <svg class="techpack-btn__icon" width="14" height="14" viewBox="0 0 16 16">
              <path d="M8 2v12m-6-6h12" stroke="currentColor" stroke-width="2"/>
            </svg>
            Add Colorway
          </button>
        </div>
        <div class="techpack-colorways__list">
          <!-- Colorways will be added here -->
        </div>
      </div>

      <div class="techpack-garment__total">
        <span class="techpack-garment__total-label">Garment Total:</span>
        <span class="techpack-garment__total-value">0</span>
      </div>
    </div>
  </div>
</template>

<!-- Colorway Template -->
<template id="colorway-template">
  <div class="techpack-colorway" data-colorway-id="">
    <div class="techpack-colorway__header">
      <!-- Two-Step Color Picker System -->
      <div class="techpack-colorway__color-selection">
        <div class="techpack-color-families">
          <label class="techpack-form__label">Choose a Color Family</label>
          <div class="techpack-color-families__grid">
            <button type="button" class="techpack-color-family" data-family="neutrals" data-color="#F5F5F5">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #F5F5F5 0%, #E8E8E8 50%, #C7C7C7 100%)"></div>
              <span class="techpack-color-family__label">Neutrals</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="blues" data-color="#4169E1">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #87CEEB 0%, #4169E1 50%, #0000CD 100%)"></div>
              <span class="techpack-color-family__label">Blues</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="greens" data-color="#32CD32">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #90EE90 0%, #32CD32 50%, #006400 100%)"></div>
              <span class="techpack-color-family__label">Greens</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="reds" data-color="#DC143C">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #FF6347 0%, #DC143C 50%, #8B0000 100%)"></div>
              <span class="techpack-color-family__label">Reds</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="yellows" data-color="#FFD700">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #FFFFE0 0%, #FFD700 50%, #DAA520 100%)"></div>
              <span class="techpack-color-family__label">Yellows</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="oranges" data-color="#FF8C00">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #FFA07A 0%, #FF8C00 50%, #FF4500 100%)"></div>
              <span class="techpack-color-family__label">Oranges</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="purples" data-color="#9370DB">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #DDA0DD 0%, #9370DB 50%, #4B0082 100%)"></div>
              <span class="techpack-color-family__label">Purples</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="pinks" data-color="#FF69B4">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #FFB6C1 0%, #FF69B4 50%, #C71585 100%)"></div>
              <span class="techpack-color-family__label">Pinks</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="browns" data-color="#A0522D">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #D2B48C 0%, #A0522D 50%, #8B4513 100%)"></div>
              <span class="techpack-color-family__label">Browns</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="greys" data-color="#808080">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #D3D3D3 0%, #808080 50%, #2F2F2F 100%)"></div>
              <span class="techpack-color-family__label">Greys</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="blacks" data-color="#000000">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #2F2F2F 0%, #000000 100%)"></div>
              <span class="techpack-color-family__label">Blacks</span>
            </button>
            <button type="button" class="techpack-color-family" data-family="whites" data-color="#FFFFFF">
              <div class="techpack-color-family__swatch" style="background: linear-gradient(135deg, #FFFFFF 0%, #F8F8FF 100%); border: 1px solid #E5E7EB;"></div>
              <span class="techpack-color-family__label">Whites</span>
            </button>
          </div>
        </div>
        
        <div class="techpack-color-shades" style="display: none;">
          <label class="techpack-form__label">Choose a Shade</label>
          <div class="techpack-color-shades__list">
            <!-- Shades will be populated dynamically -->
          </div>
          <div class="techpack-color-custom">
            <label class="techpack-form__label">Or enter custom color name:</label>
            <input type="text" class="techpack-form__input" placeholder="e.g., Midnight Navy, Forest Green" data-custom-color>
          </div>
        </div>
        
        <div class="techpack-colorway__name" style="display: none;">
          <label class="techpack-form__label">Colorway Name</label>
          <input type="text" class="techpack-form__input" placeholder="Selected color will appear here" readonly data-colorway-name>
        </div>
      </div>

      <!-- Pantone TPX Integration -->
      <div class="techpack-colorway__pantone" style="display: none;">
        <label class="techpack-form__label">Pantone TPX Code (Optional)</label>
        
        <div class="techpack-pantone-option">
          <label class="techpack-form__checkbox">
            <input type="checkbox" data-pantone-in-techpack>
            <span class="techpack-form__checkbox-mark"></span>
            Pantone code is inside my tech pack
          </label>
        </div>
        
        <div class="techpack-pantone-manual" style="display: block;">
          <label class="techpack-form__label">Enter Pantone TPX code</label>
          <input type="text" class="techpack-form__input" placeholder="e.g., PANTONE 19-4052 TPX" data-pantone-code>
          <div class="techpack-pantone-preview" style="display: none;">
            <div class="techpack-pantone-preview__swatch"></div>
            <span class="techpack-pantone-preview__name"></span>
          </div>
        </div>
        
        <div class="techpack-pantone-note">
          <p class="techpack-form__help-text">
            Pantone TPX codes are the most accurate way to specify colors and are widely used for color evaluation in textiles. If you do not provide one, we will match your selected color as closely as possible.
          </p>
        </div>
        
        <div class="techpack-custom-color-warning" style="display: none;">
          <p class="techpack-form__warning">
            Custom colors may require lab-dip approval and add 2–4 weeks to production time.
          </p>
        </div>
      </div>
      
      <!-- Sample Request -->
      <div class="techpack-colorway__sample" style="display: none;">
        <label class="techpack-form__checkbox">
          <input type="checkbox" data-sample-request>
          <span class="techpack-form__checkbox-mark"></span>
          Request sample
        </label>
        <div class="techpack-sample-quantity" style="display: none;">
          <label class="techpack-form__label">Sample Quantity</label>
          <input type="number" class="techpack-form__input techpack-form__input--small" value="1" min="1" max="5" data-sample-quantity>
        </div>
      </div>
      <button type="button" class="techpack-colorway__remove" aria-label="Remove colorway">
        <svg width="16" height="16" viewBox="0 0 16 16">
          <path d="M12 4L4 12m0-8l8 8" stroke="currentColor" stroke-width="2"/>
        </svg>
      </button>
    </div>

    <div class="techpack-size-grid" style="display: none;">
      <div class="techpack-size-grid__header">
        <div class="techpack-size-grid__label">Size</div>
        <div class="techpack-size-grid__label">XXS</div>
        <div class="techpack-size-grid__label">XS</div>
        <div class="techpack-size-grid__label">S</div>
        <div class="techpack-size-grid__label">M</div>
        <div class="techpack-size-grid__label">L</div>
        <div class="techpack-size-grid__label">XL</div>
        <div class="techpack-size-grid__label">XXL</div>
      </div>
      <div class="techpack-size-grid__row">
        <div class="techpack-size-grid__label">Qty</div>
        <input type="number" class="techpack-size-grid__input" name="qty-xxs" min="0" value="0" data-size="xxs">
        <input type="number" class="techpack-size-grid__input" name="qty-xs" min="0" value="0" data-size="xs">
        <input type="number" class="techpack-size-grid__input" name="qty-s" min="0" value="0" data-size="s">
        <input type="number" class="techpack-size-grid__input" name="qty-m" min="0" value="0" data-size="m">
        <input type="number" class="techpack-size-grid__input" name="qty-l" min="0" value="0" data-size="l">
        <input type="number" class="techpack-size-grid__input" name="qty-xl" min="0" value="0" data-size="xl">
        <input type="number" class="techpack-size-grid__input" name="qty-xxl" min="0" value="0" data-size="xxl">
      </div>
    </div>

    <div class="techpack-colorway__total">
      <span class="techpack-colorway__total-label">Colorway Total:</span>
      <span class="techpack-colorway__total-value">0</span>
    </div>
  </div>
</template>

{% schema %}
{
  "name": "Tech-Pack Step 3",
  "settings": [
    {
      "type": "header",
      "content": "Garment Specifications Step"
    },
    {
      "type": "text",
      "id": "step_title",
      "label": "Step Title",
      "default": "Garment Specifications"
    },
    {
      "type": "text",
      "id": "step_subtitle",
      "label": "Step Subtitle",
      "default": "Define your garment details and quantity requirements"
    },
    {
      "type": "number",
      "id": "minimum_quantity",
      "label": "Minimum Total Quantity",
      "default": 75
    }
  ],
  "presets": [
    {
      "name": "Tech-Pack Step 3"
    }
  ]
}
{% endschema %}