{% comment %}
  Renders a dashboard drawer menu for mobile.

  Usage:
  {% render 'dashboard-drawer' %}
{% endcomment %}

<header-drawer data-breakpoint="tablet">
  <details id="Details-menu-drawer-container" class="menu-drawer-container">
    <summary
      class="header__icon header__icon--menu header__icon--summary link focus-inset"
      aria-label="Dashboard Menu"
    >
      <span>
        {% render 'icon-hamburger' %}
        {% render 'icon-close' %}
      </span>
    </summary>
    <div id="menu-drawer" class="gradient menu-drawer motion-reduce color-{{ section.settings.color_scheme }}">
      <div class="menu-drawer__inner-container">
        <div class="menu-drawer__navigation-container">

          {%- comment -%} Dashboard Navigation - Simple flat menu {%- endcomment -%}
          <nav class="menu-drawer__navigation">
            <ul class="menu-drawer__menu list-menu" role="list">

              <li>
                <a
                  href="{{ routes.account_url }}"
                  class="menu-drawer__menu-item list-menu__item link link--text{% if request.path == routes.account_url %} menu-drawer__menu-item--active{% endif %}"
                  {% if request.path == routes.account_url %}
                    aria-current="page"
                  {% endif %}
                >
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                  </svg>
                  Dashboard
                </a>
              </li>

              <li>
                <a
                  href="{{ routes.account_url }}?view=orders"
                  class="menu-drawer__menu-item list-menu__item link link--text{% if request.path contains 'orders' %} menu-drawer__menu-item--active{% endif %}"
                  {% if request.path contains 'orders' %}
                    aria-current="page"
                  {% endif %}
                >
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                    <path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"></path>
                    <polyline points="3.29 7 12 12 20.71 7"></polyline>
                    <line x1="12" y1="22" x2="12" y2="12"></line>
                  </svg>
                  Orders
                </a>
              </li>

              <li>
                <a
                  href="{{ routes.account_url }}?view=files"
                  class="menu-drawer__menu-item list-menu__item link link--text{% if request.path contains 'files' %} menu-drawer__menu-item--active{% endif %}"
                  {% if request.path contains 'files' %}
                    aria-current="page"
                  {% endif %}
                >
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                  </svg>
                  Files
                </a>
              </li>

              <li>
                <a
                  href="{{ routes.account_url }}?view=settings"
                  class="menu-drawer__menu-item list-menu__item link link--text{% if request.path contains 'settings' %} menu-drawer__menu-item--active{% endif %}"
                  {% if request.path contains 'settings' %}
                    aria-current="page"
                  {% endif %}
                >
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M12 1v6m0 6v6m0-6h6m-6 0H6m12-6a3 3 0 0 1 0 6m-12 0a3 3 0 0 1 0-6m12 6a3 3 0 0 1 0 6m-12 0a3 3 0 0 1 0-6"></path>
                  </svg>
                  Settings
                </a>
              </li>

            </ul>
          </nav>

          {%- comment -%} Access Code Display + Utility Links {%- endcomment -%}
          <div class="menu-drawer__utility-links">

            {%- comment -%} Access Code Display in Mobile Menu {%- endcomment -%}
            {%- assign access_code = customer.metafields.custom.access_code | default: 'PENDING' -%}
            <div class="mobile-access-code">
              <span class="mobile-access-code-label">YOUR ACCESS CODE</span>
              <span class="mobile-access-code-value">{{ access_code }}</span>
            </div>

            {%- comment -%} Profile Link {%- endcomment -%}
            {%- if shop.customer_accounts_enabled and customer -%}
              <a
                href="{{ routes.account_url }}?view=profile"
                class="menu-drawer__account link focus-inset"
              >
                {% render 'icon-account' %}
                Profile
              </a>
            {%- endif -%}

            {%- comment -%} Log Out Link {%- endcomment -%}
            {%- if customer -%}
              <a
                href="{{ routes.account_logout_url }}"
                class="menu-drawer__logout link focus-inset"
              >
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.5rem;">
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                  <polyline points="16 17 21 12 16 7"></polyline>
                  <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Log Out
              </a>
            {%- endif -%}

            {%- comment -%} Localization Forms (if enabled) {%- endcomment -%}
            {%- if localization.available_countries or localization.available_languages -%}
              <div class="menu-drawer__localization header-localization">
                {%- if localization.available_countries and localization.available_countries.size > 1 -%}
                  <localization-form class="no-js-hidden">
                    {%- form 'localization', id: 'HeaderCountryMobileForm', class: 'localization-form' -%}
                      <div>
                        <h2 class="visually-hidden" id="HeaderCountryMobileLabel">
                          {{ 'localization.country_label' | t }}
                        </h2>
                        {%- render 'country-localization', localPosition: 'HeaderCountryMobile' -%}
                      </div>
                    {%- endform -%}
                  </localization-form>
                {% endif %}

                {%- if localization.available_languages and localization.available_languages.size > 1 -%}
                  <localization-form class="no-js-hidden">
                    {%- form 'localization', id: 'HeaderLanguageMobileForm', class: 'localization-form' -%}
                      <div>
                        <h2 class="visually-hidden" id="HeaderLanguageLabel">
                          {{ 'localization.language_label' | t }}
                        </h2>
                        {%- render 'language-localization', localPosition: 'HeaderLanguageMobile' -%}
                      </div>
                    {%- endform -%}
                  </localization-form>
                {%- endif -%}
              </div>
            {%- endif -%}

          </div>
        </div>
      </div>
    </div>
  </details>
</header-drawer>

<style>
  /* Mobile Access Code Styling */
  .mobile-access-code {
    display: flex;
    flex-direction: column;
    padding: 1rem 1.5rem;
    background: rgba(0, 0, 0, 0.05);
    border-radius: 8px;
    margin: 1rem 0;
  }

  .mobile-access-code-label {
    font-size: 0.65rem;
    font-weight: 600;
    color: #999999;
    letter-spacing: 0.1rem;
    text-transform: uppercase;
    line-height: 1;
    margin-bottom: 0.5rem;
  }

  .mobile-access-code-value {
    font-size: 1.1rem;
    font-weight: 700;
    color: #333333;
    letter-spacing: 0.08rem;
    line-height: 1;
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
  }

  /* Menu Items with Icons */
  .menu-drawer__menu-item {
    display: flex;
    align-items: center;
    padding: 1rem 1.5rem;
  }

  .menu-drawer__menu-item svg {
    flex-shrink: 0;
  }

  /* Logout Button Styling */
  .menu-drawer__logout {
    display: flex;
    align-items: center;
    padding: 1rem 1.5rem;
    color: #dc2626;
    font-weight: 500;
  }

  .menu-drawer__logout:hover {
    background: rgba(220, 38, 38, 0.05);
  }

  /* Profile Link Styling */
  .menu-drawer__account {
    display: flex;
    align-items: center;
    padding: 1rem 1.5rem;
    gap: 0.5rem;
  }
</style>
