{% comment %}
  TechPack V11 - Quotation Step 3: Garment Builder (Visual 2-Step)
  Purpose: Select garment types and fabrics using visual cards
  Flow: Select Garment → Select Fabric → Added to List
{% endcomment %}

{{ 'techpack-v11-base.css' | asset_url | stylesheet_tag }}
{{ 'techpack-v11-flow.css' | asset_url | stylesheet_tag }}
{{ 'techpack-v11-forms.css' | asset_url | stylesheet_tag }}

<div class="techpack-v11 techpack-flow" data-section-id="{{ section.id }}" data-flow-type="quotation" data-current-step="3">

  {%- comment -%} TEST MODE BANNER {%- endcomment -%}
  <div class="test-mode-banner" id="testModeBanner" style="display: none;">
    <div class="test-mode-banner__content">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <div>
        <strong>TEST MODE ACTIVE</strong>
        <p>2 test garments auto-added for testing.</p>
      </div>
    </div>
  </div>

  {%- comment -%} Progress Header {%- endcomment -%}
  <div class="techpack-progress">
    <div class="techpack-progress__container">
      <button type="button" class="techpack-progress__back" data-action="previous-step">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span>Back</span>
      </button>

      <div class="techpack-progress__steps">
        <div class="progress-step progress-step--complete" data-step="1">
          <div class="progress-step__circle">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13.333 4L6 11.333L2.667 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="progress-step__label">Client Info</div>
        </div>
        <div class="progress-step__line"></div>
        <div class="progress-step progress-step--complete" data-step="2">
          <div class="progress-step__circle">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13.333 4L6 11.333L2.667 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="progress-step__label">Files</div>
        </div>
        <div class="progress-step__line"></div>
        <div class="progress-step progress-step--active" data-step="3">
          <div class="progress-step__circle">3</div>
          <div class="progress-step__label">Garments</div>
        </div>
        <div class="progress-step__line"></div>
        <div class="progress-step" data-step="4">
          <div class="progress-step__circle">4</div>
          <div class="progress-step__label">Review</div>
        </div>
      </div>

      <div class="techpack-progress__save">
        <div class="save-indicator" id="saveIndicator">
          <svg class="save-indicator__icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13.333 4L6 11.333L2.667 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span class="save-indicator__text">All saved</span>
        </div>
      </div>
    </div>
  </div>

  {%- comment -%} Main Content {%- endcomment -%}
  <div class="techpack-content">
    <div class="techpack-content__container techpack-content__container--wide">

      {%- comment -%} Step Header {%- endcomment -%}
      <header class="step-header">
        <div class="step-header__badge">Step 3 of 4</div>
        <h1 class="step-header__title" id="stepTitle">Select Garments & Fabrics</h1>
        <p class="step-header__description" id="stepDescription">
          Choose garment types and their fabric compositions for your quotation
        </p>
      </header>

      {%- comment -%} Garment List (Always Visible at Top) {%- endcomment -%}
      <div class="form-section" id="garmentListSection" style="display: none;">
        <div class="section-header">
          <div class="section-header__title-row">
            <h3 class="section-header__title">Your Garments</h3>
            <span class="garment-count" id="garmentCount">0 garments</span>
          </div>
        </div>

        <div class="garment-list" id="garmentList"></div>
      </div>

      {%- comment -%} Step 1: Garment Type Selection {%- endcomment -%}
      <div class="selection-step" id="garmentTypeStep">
        <div class="form-section">
          <div class="section-header">
            <h3 class="section-header__title">Step 1: Select Garment Type</h3>
            <p class="section-header__description">Choose a garment type to add</p>
          </div>

          <div class="selection-grid selection-grid--compact">

            {%- comment -%} T-Shirt {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="T-Shirt" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20 26L26 20L40 26L54 20L60 26V60H20V26Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <path d="M26 20V26M54 20V26M20 33H60" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">T-Shirt</h4>
            </button>

            {%- comment -%} Hoodie {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Hoodie" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M16 30L26 20L40 23L54 20L64 30V63H16V30Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <path d="M33 20Q40 13 47 20" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Hoodie</h4>
            </button>

            {%- comment -%} Sweatshirt {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Sweatshirt" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M16 30L26 20L40 26L54 20L64 30V63H16V30Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <circle cx="40" cy="43" r="5" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Sweatshirt</h4>
            </button>

            {%- comment -%} Polo Shirt {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Polo Shirt" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20 26L26 20L40 26L54 20L60 26V60H20V26Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <path d="M36 26V36M44 26V36" stroke="currentColor" stroke-width="2"/>
                  <rect x="33" y="23" width="14" height="6" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Polo Shirt</h4>
            </button>

            {%- comment -%} Tank Top {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Tank Top" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M26 23L33 20H47L54 23V60H26V23Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Tank Top</h4>
            </button>

            {%- comment -%} Long Sleeve {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Long Sleeve" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M20 26L26 20L40 26L54 20L60 26V60H20V26Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <path d="M20 26L13 33V53L20 50M60 26L67 33V53L60 50" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Long Sleeve</h4>
            </button>

            {%- comment -%} Shorts {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Shorts" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M26 20H54V45L47 50H33L26 45V20Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <path d="M40 20V50" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Shorts</h4>
            </button>

            {%- comment -%} Joggers {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Joggers" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M26 20H54V60L47 63H33L26 60V20Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <path d="M40 20V63" stroke="currentColor" stroke-width="2"/>
                  <circle cx="33" cy="63" r="3" stroke="currentColor" stroke-width="2"/>
                  <circle cx="47" cy="63" r="3" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Joggers</h4>
            </button>

            {%- comment -%} Zip Hoodie {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Zip Hoodie" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M16 30L26 20L40 23L54 20L64 30V63H16V30Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <path d="M33 20Q40 13 47 20M40 23V63" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Zip Hoodie</h4>
            </button>

            {%- comment -%} Jacket {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-garment-type="Jacket" data-action="select-garment-type">
              <div class="selection-card-compact__image">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M16 30L26 20L40 23L54 20L64 30V56H16V30Z" stroke="currentColor" stroke-width="2" fill="var(--color-surface)"/>
                  <path d="M40 23V56M30 30H50M30 40H50" stroke="currentColor" stroke-width="2"/>
                </svg>
              </div>
              <h4 class="selection-card-compact__title">Jacket</h4>
            </button>

          </div>
        </div>
      </div>

      {%- comment -%} Step 2: Fabric Selection {%- endcomment -%}
      <div class="selection-step" id="fabricTypeStep" style="display: none;">
        <div class="form-section">
          <div class="section-header">
            <div class="section-header__title-row">
              <h3 class="section-header__title">Step 2: Select Fabric</h3>
              <button type="button" class="button-link" data-action="back-to-garment-types">
                ← Back to garment types
              </button>
            </div>
            <p class="section-header__description" id="fabricStepDescription">Choose fabric for your garment</p>
          </div>

          <div class="selection-grid selection-grid--compact">

            {%- comment -%} 100% Cotton {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="100% Cotton" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="20" cy="20" r="10" stroke="currentColor" stroke-width="1.5"/>
                    <path d="M20 12.5V27.5M12.5 20H27.5" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">100% Cotton</h4>
              <p class="selection-card-compact__meta">180 GSM</p>
            </button>

            {%- comment -%} 70/30 Cotton/Poly {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="70/30 Cotton/Poly" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #e8e8e8 0%, #d0d0d0 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="15" cy="20" r="7.5" stroke="currentColor" stroke-width="1.5"/>
                    <circle cx="25" cy="20" r="7.5" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">70/30 Blend</h4>
              <p class="selection-card-compact__meta">Cotton/Poly</p>
            </button>

            {%- comment -%} 80/20 Cotton/Poly {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="80/20 Cotton/Poly" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #ebebeb 0%, #d5d5d5 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="15" cy="20" r="7.5" stroke="currentColor" stroke-width="1.5"/>
                    <circle cx="25" cy="20" r="7.5" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">80/20 Blend</h4>
              <p class="selection-card-compact__meta">Cotton/Poly</p>
            </button>

            {%- comment -%} 50/50 Cotton/Poly {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="50/50 Cotton/Poly" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #e5e5e5 0%, #cccccc 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="15" cy="20" r="7.5" stroke="currentColor" stroke-width="1.5"/>
                    <circle cx="25" cy="20" r="7.5" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">50/50 Blend</h4>
              <p class="selection-card-compact__meta">Cotton/Poly</p>
            </button>

            {%- comment -%} Organic Cotton {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="100% Organic Cotton" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #f0f4f0 0%, #d8e4d8 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 10C20 10 25 15 25 20C25 25 20 30 20 30C20 30 15 25 15 20C15 15 20 10 20 10Z" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">Organic Cotton</h4>
              <p class="selection-card-compact__meta">GOTS Certified</p>
            </button>

            {%- comment -%} French Terry {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="French Terry" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #eaeaea 0%, #c8c8c8 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="15" width="20" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    <path d="M12.5 17.5H27.5M12.5 20H27.5M12.5 22.5H27.5" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">French Terry</h4>
              <p class="selection-card-compact__meta">280 GSM</p>
            </button>

            {%- comment -%} Fleece 320gsm {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="Fleece 320gsm" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #e0e0e0 0%, #bebebe 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="15" width="20" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    <path d="M12.5 17.5H27.5M12.5 20H27.5M12.5 22.5H27.5" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">Fleece 320gsm</h4>
              <p class="selection-card-compact__meta">Heavyweight</p>
            </button>

            {%- comment -%} Brushed Fleece {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="Brushed Fleece" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #e5e5e5 0%, #c0c0c0 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="10" y="15" width="20" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/>
                    <path d="M12.5 17.5H27.5M12.5 20H27.5M12.5 22.5H27.5" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">Brushed Fleece</h4>
              <p class="selection-card-compact__meta">Soft Interior</p>
            </button>

            {%- comment -%} Performance Poly {%- endcomment -%}
            <button type="button" class="selection-card-compact" data-fabric-type="Performance Poly" data-action="select-fabric-type">
              <div class="selection-card-compact__image">
                <div class="fabric-swatch" style="background: linear-gradient(135deg, #d8d8d8 0%, #b8b8b8 100%);">
                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20 12L25 17L20 22L15 17L20 12Z" stroke="currentColor" stroke-width="1.5"/>
                    <path d="M20 18L25 23L20 28L15 23L20 18Z" stroke="currentColor" stroke-width="1.5"/>
                  </svg>
                </div>
              </div>
              <h4 class="selection-card-compact__title">Performance Poly</h4>
              <p class="selection-card-compact__meta">Moisture-wicking</p>
            </button>

          </div>
        </div>
      </div>

      {%- comment -%} Form Navigation {%- endcomment -%}
      <div class="form-navigation">
        <button
          type="button"
          class="button-secondary"
          data-action="previous-step"
        >
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          Back to Files
        </button>

        <button
          type="button"
          class="button-primary"
          data-action="next-step"
          id="continueToReviewButton"
        >
          Continue to Review
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7.5 15L12.5 10L7.5 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

    </div>
  </div>

</div>

<script>
  window.TECHPACK_V11_CUSTOMER = {
    isLoggedIn: {{ customer | json }} !== null
  };
</script>

{% render 'techpack-v11-theme-switcher' %}

<script src="{{ 'techpack-v11-core.js' | asset_url }}" defer></script>
<script src="{{ 'techpack-v11-actions.js' | asset_url }}" defer></script>

{% schema %}
{
  "name": "TP V11 Quote Step 3",
  "class": "section-techpack-v11-step",
  "settings": [
    {
      "type": "header",
      "content": "Step Configuration"
    }
  ],
  "presets": [
    {
      "name": "TechPack V11 - Quotation Step 3"
    }
  ]
}
{% endschema %}
