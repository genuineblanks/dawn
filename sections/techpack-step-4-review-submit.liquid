{% comment %}
Tech-Pack Step 4: Review & Submit Section
{% endcomment %}

{{ 'techpack-mobile-layout-fix.css' | asset_url | stylesheet_tag }}

<section id="techpack-step-4" class="techpack-step" data-step="4" style="display: none;">
  <div class="techpack-container">
    <div class="techpack-progress">
      <div class="techpack-progress__bar">
        <div class="techpack-progress__fill" style="width: 100%"></div>
      </div>
      <div class="techpack-progress__steps">
        <div class="techpack-progress__step techpack-progress__step--completed">
          <div class="techpack-progress__step-circle techpack-progress__step--completed">1</div>
          <div class="techpack-progress__step-label">Client Info</div>
        </div>
        <div class="techpack-progress__step techpack-progress__step--completed">
          <div class="techpack-progress__step-circle techpack-progress__step--completed">2</div>
          <div class="techpack-progress__step-label">File Upload</div>
        </div>
        <div class="techpack-progress__step techpack-progress__step--completed">
          <div class="techpack-progress__step-circle techpack-progress__step--completed">3</div>
          <div class="techpack-progress__step-label">Garments</div>
        </div>
        <div class="techpack-progress__step techpack-progress__step--active">
          <div class="techpack-progress__step-circle techpack-progress__step-circle--active">4</div>
          <div class="techpack-progress__step-label">Review</div>
        </div>
      </div>
    </div>

    <div class="techpack-content">
      <h2 class="techpack-title">Review & Submit</h2>
      <p class="techpack-subtitle">Please review your submission before sending</p>

      <div class="techpack-review">
        <!-- Step 1 Review: Client Information -->
        <div class="techpack-review__section">
          <div class="techpack-review__header">
            <h3 class="techpack-review__title">
              <svg class="techpack-review__icon" width="20" height="20" viewBox="0 0 20 20">
                <!-- simple user icon -->
                <circle cx="10" cy="6" r="3" fill="currentColor"/>
                <path d="M4 18c0-3.3 2.7-6 6-6s6 2.7 6 6" stroke="currentColor" stroke-width="1.5" fill="none"/>
              </svg>
              Client Information
            </h3>
            <button type="button" class="techpack-review__edit" data-edit-step="1">Edit</button>
          </div>
          <div class="techpack-review__content" id="review-client-content">
            <!-- populated by populateClientReview() -->
          </div>
        </div>

        <!-- Step 2 Review: Uploaded Files -->
        <div class="techpack-review__section">
          <div class="techpack-review__header">
            <h3 class="techpack-review__title">
              <svg class="techpack-review__icon" width="20" height="20" viewBox="0 0 20 20">
                <!-- simple file icon -->
                <path d="M4 2h8l4 4v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z" stroke="currentColor" stroke-width="1.5" fill="none"/>
                <path d="M12 2v4h4" stroke="currentColor" stroke-width="1.5" fill="none"/>
              </svg>
              Uploaded Files
            </h3>
            <button type="button" class="techpack-review__edit" data-edit-step="2">Edit</button>
          </div>
          <div class="techpack-review__content" id="review-files-content">
            <!-- populated by populateFilesReview() -->
          </div>
        </div>

        <!-- Step 3 Review: Garment Specifications -->
        <div class="techpack-review__section">
          <div class="techpack-review__header">
            <h3 class="techpack-review__title">
              <svg class="techpack-review__icon" width="20" height="20" viewBox="0 0 20 20">
                <path d="M10 2L3 7v11a2 2 0 002 2h10a2 2 0 002-2V7l-7-5z" fill="currentColor"/>
                <path d="M7 10h6" stroke="white" stroke-width="1.5"/>
              </svg>
              Garment Specifications
            </h3>
            <button type="button" class="techpack-review__edit" data-edit-step="3">Edit</button>
          </div>
          <div class="techpack-review__content" id="review-garments-content">
            <!-- populated by populateGarmentsReview() -->
          </div>
        </div>
        
        <!-- Summary Section -->
        <div class="techpack-review__section">
          <div class="techpack-review__header">
            <h3 class="techpack-review__title">
              <svg class="techpack-review__icon" width="20" height="20" viewBox="0 0 20 20">
                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="1.5" fill="none"/>
              </svg>
              Summary
            </h3>
          </div>
          <div class="techpack-review__content" id="review-summary-content">
            <!-- populated by populateSummaryReview() -->
          </div>
        </div>
      </div>

      <div class="techpack-disclaimer">
        <div class="techpack-disclaimer__icon">
          <svg width="24" height="24" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
            <path d="M12 8v4l2 2" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </div>
        <div class="techpack-disclaimer__content">
          <h4 class="techpack-disclaimer__title">Response Time</h4>
          <p class="techpack-disclaimer__text">
            You will receive a detailed quote within 1-5 business days depending on project complexity. 
            Our team will review all specifications and provide comprehensive pricing information.
          </p>
        </div>
      </div>

      <div class="techpack-form__actions">
        <button type="button" class="techpack-btn techpack-btn--ghost" id="step-4-prev">
          <svg class="techpack-btn__icon techpack-btn__icon--left" width="16" height="16" viewBox="0 0 16 16">
            <path d="M10 4L6 8l4 4" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
          Previous
        </button>
        <button type="button" class="techpack-btn techpack-btn--primary techpack-btn--submit" id="step-4-submit">
          <svg class="techpack-btn__icon" width="16" height="16" viewBox="0 0 16 16">
            <path d="M2 8l4 4 8-8" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
          Submit Tech-Pack
        </button>
      </div>
    </div>
  </div>
</section>

<!-- Success Modal -->
<div class="techpack-modal" id="success-modal" style="display: none;">
  <div class="techpack-modal__backdrop"></div>
  <div class="techpack-modal__content">
    <div class="techpack-modal__header">
      <h3 class="techpack-modal__title">Submission Successful!</h3>
      <button type="button" class="techpack-modal__close" id="close-success-modal">
        <svg width="20" height="20" viewBox="0 0 20 20">
          <path d="M15 5L5 15m0-10l10 10" stroke="currentColor" stroke-width="2"/>
        </svg>
      </button>
    </div>
    <div class="techpack-modal__body">
      <div class="techpack-success">
        <div class="techpack-success__icon">
          <svg width="48" height="48" viewBox="0 0 48 48">
            <circle cx="24" cy="24" r="20" fill="#6b7280"/>
            <path d="M16 24l6 6 12-12" stroke="white" stroke-width="3" fill="none"/>
          </svg>
        </div>
        <h4 class="techpack-success__title">Your tech-pack has been submitted!</h4>
        <p class="techpack-success__message">
          Thank you for your submission. Our team has received your tech-pack request and will review it shortly. 
          You'll receive a detailed quote within 1-5 business days at <strong id="success-email"></strong>.
        </p>
        <div class="techpack-success__reference">
          <span class="techpack-success__reference-label">Reference ID:</span>
          <span class="techpack-success__reference-value" id="submission-reference"></span>
        </div>
      </div>
    </div>
    <div class="techpack-modal__footer">
      <button type="button" class="techpack-btn techpack-btn--primary" id="close-and-reset">
        Start New Submission
      </button>
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div class="techpack-loading" id="loading-overlay" style="display: none;">
  <div class="techpack-loading__backdrop"></div>
  <div class="techpack-loading__content">
    <div class="techpack-loading__spinner">
      <svg width="48" height="48" viewBox="0 0 48 48">
        <circle cx="24" cy="24" r="20" stroke="currentColor" stroke-width="4" fill="none" opacity="0.3"/>
        <circle cx="24" cy="24" r="20" stroke="currentColor" stroke-width="4" fill="none" stroke-dasharray="125.6" stroke-dashoffset="125.6" class="techpack-loading__circle"/>
      </svg>
    </div>
    <p class="techpack-loading__text">Submitting your tech-pack...</p>
  </div>
</div>

<!-- Hidden Contact Form (Fallback) -->
<form id="fallback-contact-form" style="display: none;" action="{{ routes.contact_url }}" method="post">
  <input type="hidden" name="form_type" value="contact">
  <input type="hidden" name="utf8" value="âœ“">
  <input type="hidden" name="contact[name]" id="fallback-name">
  <input type="hidden" name="contact[email]" id="fallback-email">
  <input type="hidden" name="contact[subject]" value="Tech-Pack Submission">
  <textarea name="contact[body]" id="fallback-body" style="display: none;"></textarea>
</form>

{% schema %}
{
  "name": "Tech-Pack Step 4",
  "settings": [
    {
      "type": "header",
      "content": "Review & Submit Step"
    },
    {
      "type": "text",
      "id": "step_title",
      "label": "Step Title",
      "default": "Review & Submit"
    },
    {
      "type": "text",
      "id": "step_subtitle",
      "label": "Step Subtitle",
      "default": "Please review your submission before sending"
    },
    {
      "type": "text",
      "id": "submission_email",
      "label": "Submission Email",
      "default": "office@genuineblanks.com"
    },
    {
      "type": "text",
      "id": "response_time_text",
      "label": "Response Time Text",
      "default": "You will receive a detailed quote within 1-5 business days depending on project complexity."
    }
  ],
  "presets": [
    {
      "name": "Tech-Pack Step 4"
    }
  ]
}
{% endschema %}