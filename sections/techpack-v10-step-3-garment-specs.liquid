{% comment %}
TechPack V10 Step 3: Premium Studio-Based Garment Specifications
Enhanced with Visual Studio Guide System
{% endcomment %}

{{ 'V10-techpack-studios.css' | asset_url | stylesheet_tag }}
{{ 'V10-visual-studio-guide.css' | asset_url | stylesheet_tag }}

<section id="techpack-v10-step-3" class="v10-techpack-step" data-step="3" style="display: none;">
  <div class="techpack-container">
    
    <!-- Simple Progress Bar -->
    <div class="simple-progress-container">
      <div class="simple-progress-bar">
        <div class="simple-progress-fill" style="width: 75%"></div>
      </div>
      <div class="simple-progress-steps">
        <div class="simple-step completed">
          <div class="simple-step-circle">‚úì</div>
          <span>Client Info</span>
        </div>
        <div class="simple-step completed">
          <div class="simple-step-circle">‚úì</div>
          <span>File Upload</span>
        </div>
        <div class="simple-step active">
          <div class="simple-step-circle">3</div>
          <span>Garment Specifications</span>
        </div>
        <div class="simple-step">
          <div class="simple-step-circle">4</div>
          <span>Review</span>
        </div>
      </div>
    </div>

    <div class="techpack-content">
      
      <!-- Header with Help -->
      <div class="techpack-header-with-help">
        <div class="techpack-header-content">
          <h2 class="techpack-title">Garment Specifications</h2>
          <p class="techpack-subtitle" id="step-3-subtitle">Configure your garment specifications using our professional studios</p>
        </div>
        
        <div class="techpack-header-actions">
          <!-- Theme Toggle Button -->
          <div class="v10-theme-toggle v10-theme-toggle--header">
            <button type="button" class="v10-theme-btn v10-theme-btn--light v10-theme-btn--active" data-theme="light">
              ‚òÄÔ∏è Light
            </button>
            <button type="button" class="v10-theme-btn v10-theme-btn--dark" data-theme="dark">
              üåô Dark
            </button>
          </div>
        </div>
        
        <div class="techpack-help-buttons">
          <button type="button" class="techpack-help-btn techpack-help-btn--secondary quick-guide-trigger" id="step-3-quick-guide-btn" aria-label="Open Quick Guide - Simple overview of the process">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
              <circle cx="12" cy="17" r="1"/>
            </svg>
            <span>QUICK GUIDE</span>
          </button>
          <button type="button" class="techpack-help-btn techpack-help-btn--primary visual-guide-trigger" id="step-3-help-btn" aria-label="Open Visual Studio Guide - Interactive help for understanding the workflow">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
              <circle cx="12" cy="17" r="1"/>
            </svg>
            <span>VISUAL STUDIO GUIDE</span>
          </button>
        </div>
      </div>

      <!-- Studio Navigator -->
      <div class="studio-navigator">
        <div class="studio-tabs-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
        </div>
        <div class="studio-tabs">
          <button type="button" class="studio-tab studio-tab--active" data-studio="garment" id="garment-studio-tab">
            <div class="studio-tab__icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"/>
                <line x1="16" y1="8" x2="2" y2="22"/>
                <line x1="17.5" y1="15" x2="9" y2="15"/>
              </svg>
            </div>
            <div class="studio-tab__content">
              <span class="studio-tab__title">Garment Studio</span>
              <span class="studio-tab__subtitle">Configure specifications</span>
            </div>
          </button>

          <button type="button" class="studio-tab" data-studio="design" id="design-studio-tab" style="display: none;">
            <div class="studio-tab__icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
            </div>
            <div class="studio-tab__content">
              <span class="studio-tab__title">Design Studio</span>
              <span class="studio-tab__subtitle">Colors & samples</span>
            </div>
          </button>

          <button type="button" class="studio-tab" data-studio="quantities" id="quantities-studio-tab" style="display: none;">
            <div class="studio-tab__icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                <line x1="16" y1="2" x2="16" y2="6"/>
                <line x1="8" y1="2" x2="8" y2="6"/>
                <line x1="3" y1="10" x2="21" y2="10"/>
              </svg>
            </div>
            <div class="studio-tab__content">
              <span class="studio-tab__title">Quantity Studio</span>
              <span class="studio-tab__subtitle">Sizes & quantities</span>
            </div>
          </button>
        </div>
      </div>

      <!-- Studio 1: Garment Specifications -->
      <div class="studio-container studio-container--active" id="garment-studio">
        <div class="studio-header">
          <div class="studio-header__content">
            <h3 class="studio-header__title">Garment Studio</h3>
            <span class="studio-header__badge studio-header__badge--professional">PROFESSIONAL</span>
          </div>
          <button type="button" class="studio-help-btn" data-help="garment-studio">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
              <circle cx="12" cy="17" r="1"/>
            </svg>
          </button>
        </div>

        <div class="studio-content">
          
          <!-- Garments Container -->
          <div class="garments-grid" id="garments-container">
            <!-- Garments will be dynamically added here -->
          </div>

          <!-- Add Garment Button -->
          <div class="add-garment-section">
            <button type="button" class="add-garment-btn" id="add-garment">
              <div class="add-garment-btn__icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"/>
                  <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
              </div>
              <div class="add-garment-btn__text">
                <span class="add-garment-btn__title">Add Another Garment</span>
                <span class="add-garment-btn__subtitle">Configure additional specifications</span>
              </div>
            </button>
          </div>

        </div>
      </div>

      <!-- Studio 2: Design & Lab Dip Studio (Sample Requests Only) -->
      <div class="studio-container" id="design-studio" style="display: none;">
        <div class="studio-header">
          <div class="studio-header__content">
            <h3 class="studio-header__title">Design Studio</h3>
            <span class="studio-header__badge studio-header__badge--creative">CREATIVE</span>
          </div>
          <div class="studio-header__actions">
            <div class="studio-toggle">
              <button type="button" class="studio-toggle__btn studio-toggle__btn--active" data-mode="labdips" id="labdips-mode">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="3"/>
                  <path d="M12 1v6m0 6v6"/>
                </svg>
                Lab Dips
              </button>
              <button type="button" class="studio-toggle__btn" data-mode="designs" id="designs-mode">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                Designs
              </button>
            </div>
            <button type="button" class="studio-help-btn" data-help="design-studio">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                <circle cx="12" cy="17" r="1"/>
              </svg>
            </button>
          </div>
        </div>

        <div class="studio-content">
          
          <!-- Lab Dips Mode -->
          <div class="design-mode design-mode--active" id="labdips-mode-content">
            <div class="color-studio">
              
              <!-- Color Selection Area -->
              <div class="color-selection-area">
                <div class="color-selection-header">
                  <h4>Select Your Color</h4>
                </div>

                <!-- Color Picker Input -->
                <div class="color-picker-section">
                  <div class="color-picker-left">
                    <div class="color-picker-wrapper">
                      <input type="color" id="lab-dip-color-picker" class="color-picker-input" value="#2563eb">
                      <div class="color-picker-preview" id="lab-dip-color-preview"></div>
                    </div>
                    <div class="pantone-code-input">
                      <input type="text" id="manual-pantone-code" class="pantone-input" placeholder="Or enter Pantone code (e.g., 19-4052 TPX)">
                    </div>
                  </div>
                  <div class="pantone-display-right">
                    <!-- Auto Pantone Display will be moved here -->
                    <div class="auto-pantone-display" id="auto-pantone-display" style="display: none;">
                      <div class="pantone-result">
                        <div class="pantone-circle" id="auto-pantone-circle"></div>
                        <div class="pantone-info">
                          <div class="pantone-code" id="auto-pantone-code">PANTONE 19-4052 TPX</div>
                          <div class="pantone-note">Auto-matched from 2,310+ colors</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Popular Colors Grid -->
                <div class="popular-colors-section">
                  <h5>Popular Colors</h5>
                  <div class="popular-colors-grid">
                    <div class="popular-color-circle" data-color="#000000" data-pantone="19-4007 TPX" style="background-color: #000000;" title="Black"></div>
                    <div class="popular-color-circle" data-color="#ffffff" data-pantone="11-4001 TPX" style="background-color: #ffffff; border: 1px solid #e5e7eb;" title="White"></div>
                    <div class="popular-color-circle" data-color="#dc2626" data-pantone="18-1664 TPX" style="background-color: #dc2626;" title="Red"></div>
                    <div class="popular-color-circle" data-color="#2563eb" data-pantone="19-4052 TPX" style="background-color: #2563eb;" title="Blue"></div>
                    <div class="popular-color-circle" data-color="#16a34a" data-pantone="17-6153 TPX" style="background-color: #16a34a;" title="Green"></div>
                    <div class="popular-color-circle" data-color="#eab308" data-pantone="13-0859 TPX" style="background-color: #eab308;" title="Yellow"></div>
                    <div class="popular-color-circle" data-color="#f97316" data-pantone="16-1164 TPX" style="background-color: #f97316;" title="Orange"></div>
                    <div class="popular-color-circle" data-color="#8b5cf6" data-pantone="18-3838 TPX" style="background-color: #8b5cf6;" title="Purple"></div>
                    <div class="popular-color-circle" data-color="#ec4899" data-pantone="17-2034 TPX" style="background-color: #ec4899;" title="Pink"></div>
                    <div class="popular-color-circle" data-color="#6b7280" data-pantone="18-4005 TPX" style="background-color: #6b7280;" title="Gray"></div>
                  </div>
                </div>


                <!-- Add Lab Dip Actions -->
                <div class="add-labdip-actions">
                  <button type="button" class="add-to-garment-btn" id="add-labdip-to-garment" disabled>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <line x1="12" y1="5" x2="12" y2="19"/>
                      <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    Add to Garment (‚Ç¨25)
                  </button>
                  <button type="button" class="add-fabric-swatch-btn" id="add-fabric-swatch">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                      <circle cx="8.5" cy="8.5" r="1.5"/>
                      <path d="M21 15l-5-5L5 21"/>
                    </svg>
                    Add Fabric Swatch Only (‚Ç¨25)
                  </button>
                </div>
              </div>

              <!-- Lab Dips Collection -->
              <div class="labdips-collection">
                <div class="collection-header">
                  <h4>Lab Dip Collection</h4>
                  <span class="collection-count" id="labdips-count">0 colors</span>
                </div>
                <div class="collection-grid" id="labdips-grid">
                  <!-- Lab dips will be added here -->
                </div>
                <div class="collection-empty" id="labdips-empty">
                  <div class="empty-icon">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="12" cy="12" r="3"/>
                      <path d="M12 1v6m0 6v6"/>
                    </svg>
                  </div>
                  <h5>No Lab Dips Added</h5>
                  <p>Start by selecting a color above</p>
                </div>
              </div>

            </div>
          </div>

          <!-- Design Samples Mode -->
          <div class="design-mode" id="designs-mode-content">
            <div class="design-studio">
              
              <!-- Design Input Area -->
              <div class="design-input-area">
                <div class="design-input-header">
                  <h4>Create Design Sample</h4>
                </div>

                <div class="design-input-form">
                  <div class="design-form-row">
                    <div class="design-form-group">
                      <label class="design-form-label">Design Name</label>
                      <input type="text" id="design-sample-name" class="design-form-input" placeholder="e.g., Logo Front, Back Print">
                    </div>
                    <div class="design-form-group">
                      <label class="design-form-label">Design Type</label>
                      <div class="design-type-grid">
                        <label class="design-type-option">
                          <input type="radio" name="design-type" value="Embroidery">
                          <span class="design-type-card">
                            <span class="design-type-icon">üßµ</span>
                            <span class="design-type-name">Embroidery</span>
                          </span>
                        </label>
                        <label class="design-type-option">
                          <input type="radio" name="design-type" value="Screen Print">
                          <span class="design-type-card">
                            <span class="design-type-icon">üñ®Ô∏è</span>
                            <span class="design-type-name">Screen Print</span>
                          </span>
                        </label>
                        <label class="design-type-option">
                          <input type="radio" name="design-type" value="Digital Print">
                          <span class="design-type-card">
                            <span class="design-type-icon">üé®</span>
                            <span class="design-type-name">Digital Print</span>
                          </span>
                        </label>
                        <label class="design-type-option">
                          <input type="radio" name="design-type" value="Other">
                          <span class="design-type-card">
                            <span class="design-type-icon">‚ú®</span>
                            <span class="design-type-name">Other</span>
                          </span>
                        </label>
                      </div>
                    </div>
                  </div>

                  <!-- Optional File Upload -->
                  <div class="design-form-group">
                    <label class="design-form-label">Upload Design File (Optional)</label>
                    <div class="file-upload-area" id="design-file-upload">
                      <div class="file-upload-content">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                          <polyline points="7,10 12,15 17,10"/>
                          <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        <span>Click to upload or drag file here</span>
                        <small>PNG, JPG, PDF up to 10MB</small>
                      </div>
                      <input type="file" id="design-file-input" accept=".png,.jpg,.jpeg,.pdf" hidden>
                    </div>
                  </div>

                  <!-- Add Design Actions -->
                  <div class="add-design-actions">
                    <button type="button" class="add-to-garment-btn" id="add-design-to-garment" disabled>
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                      </svg>
                      Add to Garment (‚Ç¨15)
                    </button>
                    <button type="button" class="add-fabric-design-btn" id="add-fabric-design">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                      </svg>
                      Add Fabric Design Sample (‚Ç¨15)
                    </button>
                  </div>
                </div>
              </div>

              <!-- Design Samples Collection -->
              <div class="designs-collection">
                <div class="collection-header">
                  <h4>Design Sample Collection</h4>
                  <span class="collection-count" id="designs-count">0 designs</span>
                </div>
                <div class="collection-grid" id="designs-grid">
                  <!-- Design samples will be added here -->
                </div>
                <div class="collection-empty" id="designs-empty">
                  <div class="empty-icon">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                    </svg>
                  </div>
                  <h5>No Design Samples Added</h5>
                  <p>Start by creating a design above</p>
                </div>
              </div>

            </div>
          </div>

        </div>
      </div>

      <!-- Studio 3: Quantities Studio (Bulk Orders Only) -->
      <div class="studio-container" id="quantities-studio" style="display: none;">
        <div class="studio-header">
          <div class="studio-header__content">
            <h3 class="studio-header__title">Quantity Studio</h3>
            <span class="studio-header__badge studio-header__badge--production">PRODUCTION</span>
          </div>
          <button type="button" class="studio-help-btn" data-help="quantities-studio">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
              <circle cx="12" cy="17" r="1"/>
            </svg>
          </button>
        </div>

        <div class="studio-content">
          
          <!-- Quantity Tracker -->
          <div class="quantity-tracker">
            <div class="quantity-tracker__content">
              <span class="quantity-tracker__label">Total Production Quantity:</span>
              <span class="quantity-tracker__value" id="total-production-quantity">0</span>
              <span class="quantity-tracker__minimum">/ 75 minimum</span>
            </div>
            <div class="quantity-tracker__bar">
              <div class="quantity-tracker__fill" id="production-quantity-progress" style="width: 0%"></div>
            </div>
          </div>

          <!-- Garment Quantities -->
          <div class="garment-quantities" id="garment-quantities-container">
            <!-- Quantity forms will be added here per garment -->
          </div>

        </div>
      </div>

      <!-- Standalone Items Summary (Sample Requests Only) -->
      <div class="standalone-items" id="standalone-items" style="display: none;">
        <div class="standalone-header">
          <h4>Standalone Items</h4>
          <p>Items not assigned to garments will be sent as separate samples</p>
        </div>
        
        <div class="standalone-grid">
          <div class="standalone-section">
            <h5>Fabric Swatches</h5>
            <div class="standalone-list" id="standalone-labdips">
              <!-- Unassigned lab dips -->
            </div>
          </div>
          
          <div class="standalone-section">
            <h5>Design Samples on Fabric</h5>
            <div class="standalone-list" id="standalone-designs">
              <!-- Unassigned design samples -->
            </div>
          </div>
        </div>

        <div class="standalone-cost">
          <span class="standalone-cost__label">Standalone Items Cost:</span>
          <span class="standalone-cost__value" id="standalone-cost">‚Ç¨0</span>
        </div>
      </div>

      <!-- Navigation -->
      <div class="v10-step-actions">
        <button type="button" class="v10-btn v10-btn--ghost" id="step-3-prev">
          <svg class="v10-btn-icon v10-btn-icon--left" width="16" height="16" viewBox="0 0 16 16">
            <path d="M10 4L6 8l4 4" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
          Previous
        </button>
        <button type="button" class="v10-btn v10-btn--primary" id="step-3-next" disabled>
          Next Step
          <svg class="v10-btn-icon" width="16" height="16" viewBox="0 0 16 16">
            <path d="M6 12l4-4-4-4" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
        </button>
      </div>

    </div>
  </div>

  <!-- Help Modal -->
  <div class="v10-modal-overlay" id="step-3-help-modal" style="display: none;">
    <div class="v10-modal v10-modal--help">
      <div class="v10-modal-header">
        <div class="v10-modal-icon v10-modal-icon--help">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3M12 17h.01" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <h3 class="v10-modal-title">Studio Guide</h3>
        <button type="button" class="v10-modal-close" id="close-help-modal">
          <svg width="20" height="20" viewBox="0 0 20 20">
            <path d="M15 5L5 15M5 5l10 10" stroke="currentColor" stroke-width="2"/>
          </svg>
        </button>
      </div>
      <div class="v10-modal-body">
        <div class="help-content" id="help-content">
          <!-- Help content will be populated based on request type -->
        </div>
      </div>
    </div>
  </div>

</section>

<!-- Garment Card Template -->
<template id="V10-garment-template">
  <div class="garment-card" data-garment-id="">
    <div class="garment-card__header">
      <div class="garment-card__title">
        <span class="garment-card__number">Garment 1</span>
        <div class="garment-card__status">
          <span class="status-indicator status-indicator--incomplete">Incomplete</span>
        </div>
      </div>
      <div class="garment-card__actions">
        <button type="button" class="garment-card__finalize" title="Finalize edit" style="display: none;">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 6L9 17l-5-5"/>
          </svg>
          <span>Finalize Edit</span>
        </button>
        <button type="button" class="garment-card__duplicate" title="Duplicate garment">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
          </svg>
        </button>
        <button type="button" class="garment-card__remove" title="Remove garment">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Garment Summary (shown when complete) -->
    <div class="garment-card__summary" style="display: none;">
      <div class="garment-summary">
        <div class="garment-summary__content">
          <div class="garment-summary__title">
            <span class="garment-summary__type">T-Shirt</span>
            <span class="garment-summary__separator">-</span>
            <span class="garment-summary__fabric">Cotton</span>
          </div>
          <div class="garment-summary__status">Complete</div>
        </div>
        <button type="button" class="garment-summary__edit-btn" title="Edit garment">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
          </svg>
          Edit
        </button>
      </div>
    </div>

    <div class="garment-card__content">
      
      <!-- Compact Garment & Fabric Selection Split -->
      <div class="garment-fabric-split-container">
        
        <!-- Garment Type - Left Side -->
        <div class="compact-selection-section">
          <div class="selection-header">
            <h5>Garment Type</h5>
            <button type="button" class="selection-help" data-help="garment-types">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                <circle cx="12" cy="17" r="1"/>
              </svg>
            </button>
          </div>
          
          <!-- Collapsed State -->
          <div class="compact-selection-widget" id="garment-collapsed">
            <div class="selection-placeholder" id="garment-placeholder">
              <span class="placeholder-icon">üëï</span>
              <span class="placeholder-text">Select garment type</span>
              <svg class="placeholder-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"/>
              </svg>
            </div>
            
            <div class="selection-display" id="garment-display" style="display: none;">
              <div class="selected-item">
                <span class="selected-icon" id="garment-selected-icon">üëï</span>
                <span class="selected-name" id="garment-selected-name">T-Shirt</span>
              </div>
              <button type="button" class="change-selection-btn" id="change-garment-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                  <path d="M21 3v5h-5"/>
                  <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                  <path d="M3 21v-5h5"/>
                </svg>
                Change Garment Type
              </button>
            </div>
          </div>
          
          <!-- Expanded State -->
          <div class="selection-expanded" id="garment-expanded" style="display: none;">
            <div class="compact-radio-grid" id="garment-type-grid">
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Zip-Up Hoodie">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üß•</span>
                  <span class="compact-radio-card__name">Zip-Up Hoodie</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Hoodie">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üëï</span>
                  <span class="compact-radio-card__name">Hoodie</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="T-Shirt">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üëî</span>
                  <span class="compact-radio-card__name">T-Shirt</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Sweatshirt">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üß•</span>
                  <span class="compact-radio-card__name">Sweatshirt</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Sweatpants">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üëñ</span>
                  <span class="compact-radio-card__name">Sweatpants</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Shorts">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">ü©≥</span>
                  <span class="compact-radio-card__name">Shorts</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Long Sleeve T-Shirt">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üëï</span>
                  <span class="compact-radio-card__name">Long Sleeve</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Shirt">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üëî</span>
                  <span class="compact-radio-card__name">Shirt</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Polo Shirt">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üëï</span>
                  <span class="compact-radio-card__name">Polo Shirt</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Tank Top">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üéΩ</span>
                  <span class="compact-radio-card__name">Tank Top</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Hat/Cap">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üß¢</span>
                  <span class="compact-radio-card__name">Hat/Cap</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Beanie">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üßø</span>
                  <span class="compact-radio-card__name">Beanie</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="garmentType" value="Other">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">‚ú®</span>
                  <span class="compact-radio-card__name">Other</span>
                </span>
              </label>
            </div>
          </div>
        </div>

        <!-- Fabric Type - Right Side (for quotation/sample) -->
        <div class="compact-selection-section" data-show-for="quotation,sample">
          <div class="selection-header">
            <h5>Fabric Type</h5>
            <button type="button" class="selection-help" data-help="fabric-types">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                <circle cx="12" cy="17" r="1"/>
              </svg>
            </button>
          </div>
          
          <!-- Collapsed State -->
          <div class="compact-selection-widget" id="fabric-collapsed">
            <div class="selection-placeholder" id="fabric-placeholder">
              <span class="placeholder-icon">üßµ</span>
              <span class="placeholder-text">Select fabric type</span>
              <svg class="placeholder-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"/>
              </svg>
            </div>
            
            <div class="selection-display" id="fabric-display" style="display: none;">
              <div class="selected-item">
                <span class="selected-icon" id="fabric-selected-icon">üßµ</span>
                <span class="selected-name" id="fabric-selected-name">100% Cotton</span>
              </div>
              <button type="button" class="change-selection-btn" id="change-fabric-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                  <path d="M21 3v5h-5"/>
                  <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                  <path d="M3 21v-5h5"/>
                </svg>
                Change Fabric Type
              </button>
            </div>
          </div>
          
          <!-- Expanded State -->
          <div class="selection-expanded" id="fabric-expanded" style="display: none;">
            <div class="compact-radio-grid" id="fabric-type-grid">
              <!-- Fabric options will be populated dynamically based on garment type -->
            </div>
          </div>
        </div>

        <!-- Sample Reference - Right Side (for bulk orders) -->
        <div class="compact-selection-section" data-show-for="bulk">
          <div class="selection-header">
            <h5>Sample Reference</h5>
            <button type="button" class="selection-help" data-help="sample-reference">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                <circle cx="12" cy="17" r="1"/>
              </svg>
            </button>
          </div>
          
          <!-- Collapsed State -->
          <div class="compact-selection-widget" id="sample-reference-collapsed">
            <div class="selection-placeholder" id="sample-reference-placeholder">
              <span class="placeholder-icon">üìã</span>
              <span class="placeholder-text">Select sample reference</span>
              <svg class="placeholder-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"/>
              </svg>
            </div>
            
            <div class="selection-display" id="sample-reference-display" style="display: none;">
              <div class="selected-item">
                <span class="selected-icon" id="sample-reference-selected-icon">üìã</span>
                <span class="selected-name" id="sample-reference-selected-name">Approved Sample ‚Äì As Is</span>
              </div>
              <button type="button" class="change-selection-btn" id="change-sample-reference-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                  <path d="M21 3v5h-5"/>
                  <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
                  <path d="M3 21v-5h5"/>
                </svg>
                Change Sample Reference
              </button>
            </div>
          </div>
          
          <!-- Expanded State -->
          <div class="selection-expanded" id="sample-reference-expanded" style="display: none;">
            <div class="compact-radio-grid" id="sample-reference-grid">
              <label class="compact-radio-card">
                <input type="radio" name="sampleReference" value="approved-sample">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">‚úÖ</span>
                  <span class="compact-radio-card__name">Approved Sample ‚Äì As Is</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="sampleReference" value="approved-with-changes">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üîÑ</span>
                  <span class="compact-radio-card__name">Approved Sample ‚Äì With Changes</span>
                </span>
              </label>
              <label class="compact-radio-card">
                <input type="radio" name="sampleReference" value="new-sample-version">
                <span class="compact-radio-card__content">
                  <span class="compact-radio-card__icon">üìã</span>
                  <span class="compact-radio-card__name">New Sample Version</span>
                </span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Sample Type Selection (for sample requests only) -->
      <div class="selection-section" data-show-for="sample">
        <div class="selection-header">
          <h5>Sample Type</h5>
          <button type="button" class="selection-help" data-help="sample-types">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
              <circle cx="12" cy="17" r="1"/>
            </svg>
          </button>
        </div>
        <div class="sample-type-selection">
          <div class="sample-type-card" data-value="stock">
            <input type="radio" name="sampleType" value="stock" style="display: none;">
            <div class="sample-type-card__header">
              <span class="sample-type-card__title">Stock Fabric Color</span>
              <span class="sample-type-card__price">‚Ç¨35</span>
            </div>
            <span class="sample-type-card__description">Quick validation ‚Ä¢ 1-2 weeks</span>
            <span class="sample-type-card__details">Black, off-white, or random stock color</span>
          </div>
          <div class="sample-type-card" data-value="custom">
            <input type="radio" name="sampleType" value="custom" style="display: none;">
            <div class="sample-type-card__header">
              <span class="sample-type-card__title">Custom Color (Pantone)</span>
              <span class="sample-type-card__price">‚Ç¨65</span>
            </div>
            <span class="sample-type-card__description">Exact color match ‚Ä¢ 3 weeks</span>
            <span class="sample-type-card__details">Requires Lab Dip assignment</span>
          </div>
          <div class="sample-type-card" data-value="techpack">
            <input type="radio" name="sampleType" value="techpack" style="display: none;">
            <div class="sample-type-card__header">
              <span class="sample-type-card__title">As Per TechPack</span>
              <span class="sample-type-card__price">Premium</span>
            </div>
            <span class="sample-type-card__description">Exact TechPack specifications</span>
            <span class="sample-type-card__details">Higher cost, comprehensive sample</span>
          </div>
        </div>
      </div>


      <!-- Assigned Items Display (for sample requests) -->
      <div class="assigned-items" data-show-for="sample">
        <div class="assigned-section">
          <h6>Assigned Colors</h6>
          <div class="assigned-badges" id="assigned-labdips">
            <!-- Assigned lab dips will appear as badges -->
          </div>
        </div>
        <div class="assigned-section">
          <h6>Assigned Designs</h6>
          <div class="assigned-badges" id="assigned-designs">
            <!-- Assigned design samples will appear as badges -->
          </div>
        </div>
      </div>

    </div>
  </div>
</template>

<!-- Lab Dip Item Template -->
<template id="V10-labdip-template">
  <div class="collection-item" data-labdip-id="">
    <div class="collection-item__visual">
      <div class="collection-item__color" style="background-color: #000000;"></div>
    </div>
    <div class="collection-item__content">
      <span class="collection-item__name">PANTONE 19-4052 TPX</span>
      <span class="collection-item__type">Lab Dip</span>
    </div>
    <div class="collection-item__actions">
      <button type="button" class="collection-item__assign" title="Assign to garment">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
      </button>
      <button type="button" class="collection-item__remove" title="Remove">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
  </div>
</template>

<!-- Design Sample Item Template -->
<template id="V10-design-template">
  <div class="collection-item" data-design-id="">
    <div class="collection-item__visual">
      <div class="collection-item__icon">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
        </svg>
      </div>
    </div>
    <div class="collection-item__content">
      <span class="collection-item__name">Design Name</span>
      <span class="collection-item__type">Embroidery</span>
    </div>
    <div class="collection-item__actions">
      <button type="button" class="collection-item__assign" title="Assign to garment">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
      </button>
      <button type="button" class="collection-item__remove" title="Remove">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
  </div>
</template>

<!-- Load TechPack V10 Application -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" integrity="sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="{{ 'V10-techpack-studios.js' | asset_url }}?v=10.0.0" defer="defer"></script>

<!-- Load Visual Studio Guide System -->
<script src="{{ 'V10-visual-studio-guide.js' | asset_url }}?v=1.0.0" defer="defer"></script>

<!-- Include Visual Guide Modal Component -->
{% render 'V10-visual-guide-modal' %}

<!-- Include Quick Guide Modal Component -->
{% render 'V10-quick-guide-modal' %}

{% schema %}
{
  "name": "TechPack V10 Step 3",
  "settings": [
    {
      "type": "header",
      "content": "Studio-Based Garment Specifications"
    },
    {
      "type": "text",
      "id": "step_title",
      "label": "Step Title",
      "default": "Garment Specifications"
    },
    {
      "type": "text",
      "id": "step_subtitle",
      "label": "Step Subtitle",
      "default": "Studio-quality garment builder with intelligent assignment system"
    },
    {
      "type": "number",
      "id": "minimum_quantity",
      "label": "Minimum Quantity",
      "default": 75
    }
  ],
  "presets": [
    {
      "name": "TechPack V10 Step 3"
    }
  ]
}
{% endschema %}