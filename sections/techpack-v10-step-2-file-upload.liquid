{% comment %}
TechPack V10 Step 2: File Upload - Premium Studio Design
{% endcomment %}

{{ 'V10-techpack-studios.css' | asset_url | stylesheet_tag }}

<section id="techpack-v10-step-2" class="v10-techpack-step" data-step="2" style="display: none;">
  <div class="v10-techpack-container">
    <!-- Progress Indicator -->
    <div class="v10-progress-indicator">
      <div class="v10-progress-bar">
        <div class="v10-progress-fill" style="width: 50%"></div>
      </div>
      <div class="v10-progress-steps">
        <div class="v10-progress-step v10-progress-step--completed">
          <div class="v10-progress-circle">1</div>
          <span class="v10-progress-label">Client Info</span>
        </div>
        <div class="v10-progress-step v10-progress-step--active">
          <div class="v10-progress-circle">2</div>
          <span class="v10-progress-label">Files</span>
        </div>
        <div class="v10-progress-step">
          <div class="v10-progress-circle">3</div>
          <span class="v10-progress-label">Garments</span>
        </div>
        <div class="v10-progress-step">
          <div class="v10-progress-circle">4</div>
          <span class="v10-progress-label">Review</span>
        </div>
      </div>
    </div>

    <!-- Header -->
    <div class="v10-step-header">
      <h1 class="v10-step-title">File Upload</h1>
      <p class="v10-step-subtitle">Upload your tech pack files, designs, and reference materials</p>
    </div>

    <!-- Upload Studio -->
    <div class="v10-studio-card">
      <div class="v10-studio-header">
        <h2 class="v10-studio-title">Document Upload</h2>
        <p class="v10-studio-subtitle">Drag and drop your files or click to browse</p>
      </div>

      <div class="v10-upload-zone" id="techpack-v10-upload-zone">
        <div class="v10-upload-content">
          <div class="v10-upload-icon">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
              <path d="M24 8V32M16 16L24 8L32 16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M8 32V40C8 41.1046 8.89543 42 10 42H38C39.1046 42 40 41.1046 40 40V32" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <h3 class="v10-upload-title">Drop files here to upload</h3>
          <p class="v10-upload-subtitle">or click to browse your computer</p>
          <div class="v10-upload-specs">
            <span class="v10-upload-spec">PDF, AI, PNG, JPG, ZIP</span>
            <span class="v10-upload-spec">•</span>
            <span class="v10-upload-spec">Max 10MB per file</span>
            <span class="v10-upload-spec">•</span>
            <span class="v10-upload-spec">Up to 10 files</span>
          </div>
        </div>
        <input type="file" id="techpack-v10-file-input" class="v10-upload-input" multiple accept=".pdf,.ai,.png,.jpg,.jpeg,.zip">
      </div>

      <div class="v10-upload-files" id="techpack-v10-uploaded-files"></div>

      <button type="button" class="v10-btn v10-btn--ghost v10-btn--add-files" id="techpack-v10-add-more-files" style="display: none;">
        <svg class="v10-btn-icon v10-btn-icon--left" width="16" height="16" viewBox="0 0 16 16">
          <path d="M8 2V14M2 8H14" stroke="currentColor" stroke-width="2"/>
        </svg>
        Add More Files
      </button>
    </div>

    <!-- Measurement Requirements Studio (Conditional) -->
    <div class="v10-studio-card" id="techpack-v10-measurement-studio" style="display: none;">
      <div class="v10-studio-header">
        <h2 class="v10-studio-title">Measurement Requirements</h2>
        <p class="v10-studio-subtitle">Confirm which measurements are included in your tech pack files</p>
      </div>

      <div class="v10-measurement-grid">
        <label class="v10-measurement-card">
          <input type="checkbox" name="fit_measurements" class="v10-measurement-input">
          <div class="v10-measurement-content">
            <div class="v10-measurement-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M16 4H18C19.1046 4 20 4.89543 20 6V18C20 19.1046 19.1046 20 18 20H16M8 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20H8M8 4V20M16 4V20M8 12H16" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="v10-measurement-info">
              <h3 class="v10-measurement-title">Fit Measurements</h3>
              <p class="v10-measurement-description">Body measurements or size charts for proper garment fitting</p>
            </div>
            <div class="v10-measurement-checkbox">
              <svg class="v10-measurement-check" width="16" height="16" viewBox="0 0 16 16">
                <path d="M13 4L6 11L3 8" stroke="currentColor" stroke-width="2" fill="none"/>
              </svg>
            </div>
          </div>
        </label>

        <label class="v10-measurement-card">
          <input type="checkbox" name="design_measurements" class="v10-measurement-input">
          <div class="v10-measurement-content">
            <div class="v10-measurement-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M3 3V21H21V3H3Z" stroke="currentColor" stroke-width="2"/>
                <path d="M9 9H15M9 13H15M9 17H13" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="v10-measurement-info">
              <h3 class="v10-measurement-title">Design Measurements</h3>
              <p class="v10-measurement-description">Garment specifications and technical measurements</p>
            </div>
            <div class="v10-measurement-checkbox">
              <svg class="v10-measurement-check" width="16" height="16" viewBox="0 0 16 16">
                <path d="M13 4L6 11L3 8" stroke="currentColor" stroke-width="2" fill="none"/>
              </svg>
            </div>
          </div>
        </label>

        <label class="v10-measurement-card" id="techpack-v10-design-placement-card" style="display: none;">
          <input type="checkbox" name="design_placement_measurements" class="v10-measurement-input">
          <div class="v10-measurement-content">
            <div class="v10-measurement-icon">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                <path d="M12 2L22 7L12 12L2 7L12 2Z" stroke="currentColor" stroke-width="2"/>
                <path d="M2 17L12 22L22 17M2 12L12 17L22 12" stroke="currentColor" stroke-width="2"/>
              </svg>
            </div>
            <div class="v10-measurement-info">
              <h3 class="v10-measurement-title">Design Placement</h3>
              <p class="v10-measurement-description">Print/embroidery placement specifications and positioning details</p>
            </div>
            <div class="v10-measurement-checkbox">
              <svg class="v10-measurement-check" width="16" height="16" viewBox="0 0 16 16">
                <path d="M13 4L6 11L3 8" stroke="currentColor" stroke-width="2" fill="none"/>
              </svg>
            </div>
          </div>
        </label>
      </div>

      <div class="v10-measurement-info-box">
        <div class="v10-info-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.5"/>
            <path d="M10 6V10L13 13" stroke="currentColor" stroke-width="1.5"/>
          </svg>
        </div>
        <p class="v10-info-text">These requirements affect pricing accuracy and sample development timeline</p>
      </div>

      <div class="v10-measurement-warning" id="techpack-v10-measurement-warning" style="display: none;">
        <div class="v10-warning-icon">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92z" fill="currentColor"/>
            <path d="M10 7V11M10 13H10.01" stroke="white" stroke-width="2"/>
          </svg>
        </div>
        <div class="v10-warning-content">
          <p class="v10-warning-text">
            <strong>Important:</strong> Requests with false measurement claims will be rejected. Only check boxes for measurements actually included in your tech pack files.
          </p>
        </div>
      </div>
    </div>

    <!-- File Classification Studio -->
    <div class="v10-studio-card" id="techpack-v10-classification-studio" style="display: none;">
      <div class="v10-studio-header">
        <h2 class="v10-studio-title">File Classification</h2>
        <p class="v10-studio-subtitle">Help us organize your files by specifying their types</p>
      </div>

      <div class="v10-classification-grid" id="techpack-v10-classification-grid">
        <!-- Files will be dynamically added here -->
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="v10-step-actions">
      <button type="button" class="v10-btn v10-btn--ghost" id="techpack-v10-step-2-back">
        <svg class="v10-btn-icon v10-btn-icon--left" width="16" height="16" viewBox="0 0 16 16">
          <path d="M10 4L6 8l4 4" stroke="currentColor" stroke-width="2" fill="none"/>
        </svg>
        Previous
      </button>
      
      <button type="button" class="v10-btn v10-btn--primary" id="techpack-v10-step-2-next" disabled>
        Continue to Garments
        <svg class="v10-btn-icon" width="16" height="16" viewBox="0 0 16 16">
          <path d="M6 12l4-4-4-4" stroke="currentColor" stroke-width="2" fill="none"/>
        </svg>
      </button>
    </div>
  </div>
</section>

<!-- File Item Template -->
<template id="techpack-v10-file-item-template">
  <div class="v10-file-card" data-file-id="">
    <div class="v10-file-header">
      <div class="v10-file-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z" stroke="currentColor" stroke-width="2"/>
          <path d="M14 2V8H20" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>
      <div class="v10-file-info">
        <h4 class="v10-file-name"></h4>
        <p class="v10-file-size"></p>
      </div>
      <button type="button" class="v10-file-remove" aria-label="Remove file">
        <svg width="16" height="16" viewBox="0 0 16 16">
          <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2"/>
        </svg>
      </button>
    </div>

    <div class="v10-file-classification">
      <label class="v10-form-label">
        File Type *
        <select class="v10-form-select v10-file-type-select" required>
          <option value="">⚠️ Select file type (required)</option>
          <option value="Collection">📁 Collection Tech-Pack</option>
          <option value="Single">📄 Single Garment Tech-Pack</option>
          <option value="Design">🎨 Design Reference Files</option>
          <option value="Accessories">🏷️ Accessories Reference Files</option>
        </select>
      </label>
      <div class="v10-form-error" style="display: none;"></div>
    </div>

    <div class="v10-file-progress" style="display: none;">
      <div class="v10-progress-bar">
        <div class="v10-progress-fill" style="width: 0%"></div>
      </div>
      <span class="v10-progress-text">Uploading...</span>
    </div>
  </div>
</template>

<!-- Measurement Warning Modal -->
<div class="v10-modal-overlay" id="techpack-v10-measurement-warning-modal" style="display: none;">
  <div class="v10-modal">
    <div class="v10-modal-header">
      <div class="v10-modal-icon v10-modal-icon--warning">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z" stroke="currentColor" stroke-width="2"/>
          <path d="M12 9V13M12 17H12.01" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>
      <h3 class="v10-modal-title" id="techpack-v10-warning-title">Missing Measurements</h3>
    </div>
    
    <div class="v10-modal-body">
      <p class="v10-modal-message" id="techpack-v10-warning-message">
        <!-- Dynamic message content -->
      </p>
      
      <div class="v10-modal-details" id="techpack-v10-warning-details">
        <!-- Dynamic details content -->
      </div>
    </div>
    
    <div class="v10-modal-actions">
      <button type="button" class="v10-btn v10-btn--ghost" id="techpack-v10-warning-back">
        Go Back & Add Measurements
      </button>
      <button type="button" class="v10-btn v10-btn--primary" id="techpack-v10-warning-proceed" style="display: none;">
        Continue Anyway
      </button>
    </div>
  </div>
</div>

<!-- Load TechPack V10 Application -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js" integrity="sha512-E8QSvWZ0eCLGk4km3hxSsNmGWbLtSCSUcewDQPQWZF6pEU8GlT8a5fF32wOl1i8ftdMhssTrF/OhyGWwonTcXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="{{ 'V10-techpack-studios.js' | asset_url }}?v=10.0.0" defer="defer"></script>

{% schema %}
{
  "name": "TechPack V10 Step 2",
  "settings": [
    {
      "type": "header",
      "content": "File Upload Step"
    },
    {
      "type": "text",
      "id": "step_title",
      "label": "Step Title",
      "default": "File Upload"
    },
    {
      "type": "text",
      "id": "step_subtitle",
      "label": "Step Subtitle",
      "default": "Professional drag & drop interface with intelligent file classification"
    },
    {
      "type": "number",
      "id": "max_file_size",
      "label": "Max File Size (MB)",
      "default": 10
    },
    {
      "type": "number",
      "id": "max_files",
      "label": "Max Number of Files",
      "default": 10
    }
  ],
  "presets": [
    {
      "name": "TechPack V10 Step 2"
    }
  ]
}
{% endschema %}