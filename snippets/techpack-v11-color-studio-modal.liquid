{% comment %}
  TechPack V11 - Pantone Color Studio Modal (90vw Ã— 85vh)

  Large modal (NOT full-screen) for Pantone color browsing and lab dip collection
  Features: Pantone search, HSL picker, lab dip cart, cotton garment assignment
  Main page visible/blurred behind modal for context
{% endcomment %}

<div class="color-studio-modal-overlay" id="colorStudioModalOverlay" style="display: none;">

  <div class="color-studio-modal" id="colorStudioModal">

    {%- comment -%} Modal Header {%- endcomment -%}
    <div class="color-studio-modal__header">
      <h2 class="color-studio-modal__title">Pantone Color Studio</h2>
      <button type="button" class="color-studio-modal__close" data-action="close-color-studio-modal">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M6 6L18 18M6 18L18 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </div>

    {%- comment -%} Modal Content - 2 Column Layout {%- endcomment -%}
    <div class="color-studio-modal__content">

      {%- comment -%} LEFT: Color Selection (40%) {%- endcomment -%}
      <div class="color-studio-modal__left">

        {%- comment -%} Current Selection Display {%- endcomment -%}
        <div class="modal-current-color" id="modalCurrentColor">
          <div class="modal-current-color__swatch" id="modalCurrentColorSwatch" style="background-color: #EC4899;"></div>
          <div class="modal-current-color__info">
            <p class="modal-current-color__name" id="modalCurrentColorName">Pink</p>
            <p class="modal-current-color__code" id="modalCurrentColorCode">17-2034 TPX</p>
          </div>
        </div>

        {%- comment -%} Pantone Code Search {%- endcomment -%}
        <div class="modal-search">
          <label for="modalPantoneSearch" class="modal-search__label">Pantone Code</label>
          <div class="modal-search__input-group">
            <input
              type="text"
              id="modalPantoneSearch"
              class="modal-search__input"
              placeholder="e.g., 18-1664"
              data-action="modal-search-pantone"
            />
            <button type="button" class="modal-search__btn" data-action="modal-search-pantone-button">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="9" cy="9" r="6" stroke="currentColor" stroke-width="2" fill="none"/>
                <path d="M13 13L17 17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
        </div>

        {%- comment -%} Popular Colors Grid {%- endcomment -%}
        <div class="modal-popular">
          <h4 class="modal-popular__title">Popular Colors</h4>
          <div class="modal-popular__grid" id="modalPopularColorsGrid">
            {%- comment -%} Populated by JavaScript with 18 popular Pantone colors {%- endcomment -%}
          </div>
        </div>

        {%- comment -%} Advanced HSL Picker {%- endcomment -%}
        <div class="modal-advanced">
          <h4 class="modal-advanced__title">Advanced Color Picker</h4>
          <p class="modal-advanced__description">Pick any color to find closest Pantone match</p>

          {%- comment -%} Native HTML5 Color Picker {%- endcomment -%}
          <div class="modal-color-picker-native">
            <label for="modalColorPickerInput" class="modal-color-picker-native__label">Pick a Color:</label>
            <input
              type="color"
              id="modalColorPickerInput"
              class="modal-color-picker-native__input"
              value="#EC4899"
              data-action="modal-native-color-change"
            />
          </div>

          <div class="modal-sliders">
            <div class="modal-slider">
              <label for="modalHueSlider" class="modal-slider__label">
                Hue
                <span id="modalHueValue" class="modal-slider__value">0</span>
              </label>
              <input
                type="range"
                id="modalHueSlider"
                class="modal-slider__input"
                min="0"
                max="360"
                value="0"
                data-action="modal-update-color-picker"
              />
            </div>

            <div class="modal-slider">
              <label for="modalSaturationSlider" class="modal-slider__label">
                Saturation
                <span id="modalSaturationValue" class="modal-slider__value">100%</span>
              </label>
              <input
                type="range"
                id="modalSaturationSlider"
                class="modal-slider__input"
                min="0"
                max="100"
                value="100"
                data-action="modal-update-color-picker"
              />
            </div>

            <div class="modal-slider">
              <label for="modalLightnessSlider" class="modal-slider__label">
                Lightness
                <span id="modalLightnessValue" class="modal-slider__value">50%</span>
              </label>
              <input
                type="range"
                id="modalLightnessSlider"
                class="modal-slider__input"
                min="0"
                max="100"
                value="50"
                data-action="modal-update-color-picker"
              />
            </div>
          </div>

          <div class="modal-closest-match" id="modalClosestMatch">
            <p class="modal-closest-match__label">Closest Pantone Match:</p>
            <div id="modalClosestMatchDisplay" class="modal-closest-match__display">
              {%- comment -%} Populated by JavaScript {%- endcomment -%}
            </div>
          </div>
        </div>

        {%- comment -%} Add to Collection Button {%- endcomment -%}
        <button type="button" class="modal-add-btn" data-action="modal-add-to-labdip-collection">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M10 4V16M4 10H16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Add to Lab Dip Collection
        </button>

      </div>

      {%- comment -%} RIGHT: Lab Dip Collection + Assignment (60%) {%- endcomment -%}
      <div class="color-studio-modal__right">

        <h3 class="modal-collection-title">Your Lab Dip Collection</h3>
        <p class="modal-collection-description">Build your swatch collection and assign to garments</p>

        {%- comment -%} Lab Dip Collection Cards {%- endcomment -%}
        <div class="modal-labdip-collection" id="modalLabDipCollection">
          {%- comment -%} Empty State {%- endcomment -%}
          <div class="modal-labdip-empty" id="modalLabDipEmpty">
            <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="12" y="12" width="24" height="24" rx="3" stroke="currentColor" stroke-width="2" fill="none"/>
              <path d="M24 18V30M18 24H30" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <p class="modal-labdip-empty__text">No lab dips added yet</p>
            <p class="modal-labdip-empty__hint">Select colors from the left to build your collection</p>
          </div>

          {%- comment -%} Lab Dip Cards (populated by JS) {%- endcomment -%}
          <div class="modal-labdip-cards" id="modalLabDipCards">
            {%- comment -%} Populated by JavaScript {%- endcomment -%}
          </div>
        </div>

        {%- comment -%} Divider {%- endcomment -%}
        <div class="modal-divider"></div>

        {%- comment -%} Garment Assignment Area {%- endcomment -%}
        <h4 class="modal-garments-title">Assign to Garments (100% Cotton Only)</h4>
        <p class="modal-garments-description">Drag colors onto garments or use dropdown to assign</p>

        <div class="modal-garments" id="modalCottonGarments">
          {%- comment -%} Populated by JavaScript with cotton-only garments {%- endcomment -%}
        </div>

      </div>

    </div>

    {%- comment -%} Modal Footer {%- endcomment -%}
    <div class="color-studio-modal__footer">
      <button type="button" class="button-secondary" data-action="close-color-studio-modal">
        Cancel
      </button>
      <button type="button" class="button-primary" data-action="done-color-studio-modal" id="modalDoneButton">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M5 10L8 13L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span id="modalDoneText">Done - 0 Colors in Cart</span>
      </button>
    </div>

  </div>

</div>

<script>
  // Inject Pantone JSON URL from Liquid to JavaScript
  window.TECHPACK_V11_PANTONE_URL = "{{ 'pantone-colors.json' | asset_url }}";
</script>
